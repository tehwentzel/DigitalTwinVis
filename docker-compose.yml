networks:
  example:
    driver: bridge

services:
  digitaltwinproxy:
    container_name: digitaltwinproxy
    image: nginx
    restart: always
    ports:
      - 443:443
      - 80:80
    volumes:
      # - ./docker/proxy/service-example/nginx.conf:/etc/nginx/nginx.conf
      - ./data/_.evl.uic.edu.key:/etc/ssl/evl.key
      - ./data/_.evl.uic.edu.crt:/etc/ssl/evl.crt
      - ./docker/proxy/https-forwarding.conf:/etc/nginx/conf.d/https-forwarding.conf
    networks: 
      - example
  digitaltwinfrontend:
    container_name: digitaltwinfrontend
    restart: unless-stopped
    build:
      context: ./docker/frontend
      dockerfile: Dockerfile
    ports:
      - 8000:8000
    networks: 
      - example
    volumes:
      - ./:/workspace/DigitalTwinVis
      - ./docker/frontend/init.sh:/usr/local/bin/init.sh
    entrypoint: sh -c "sh /usr/local/bin/init.sh"
    networks:
      - example
  digitaltwinbackend:
    container_name: digitaltwinbackend
    restart: unless-stopped
    build:
      context: ./docker/backend
      dockerfile: Dockerfile
    ports:
      - 5000:5000
    volumes:
      - ./:/workspace/DigitalTwinVis
      - ./docker/backend/init.sh:/usr/local/bin/init.sh
    entrypoint: sh -c "sh /usr/local/bin/init.sh"
    networks: 
      - example
  dassfrontend:
    container_name: dassfrontend
    restart: unless-stopped
    build:
      context: ./docker/dass_frontend
      dockerfile: Dockerfile
    ports:
      - 900:9000
    networks: 
      - example
    volumes:
      - ./:/workspace/DigitalTwinVis
      - ./docker/dass_frontend/init.sh:/usr/local/bin/init.sh
    entrypoint: sh -c "sh /usr/local/bin/init.sh"
    networks:
      - example
  dassbackend:
    container_name: dassbackend
    restart: unless-stopped
    build:
      context: ./docker/dass_backend
      dockerfile: Dockerfile
    ports:
      - 8080:8080
    volumes:
      - ./:/workspace/DigitalTwinVis
      - ./docker/dass_backend/init.sh:/usr/local/bin/init.sh
    entrypoint: sh -c "sh /usr/local/bin/init.sh"
    networks: 
      - example
